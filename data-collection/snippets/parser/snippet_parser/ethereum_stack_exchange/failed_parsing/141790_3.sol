   for (uint i = 0; i < totalSharesNo; i++) - instead of this, 
   for (uint i = 0; i < totalSharesNo-1; i++) - this should be there
